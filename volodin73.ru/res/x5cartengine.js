(function(a,b,c){"use strict",a.extend(!0,b.cart,{ecommerce:function(d){d=a.extend(!0,{settings:{indexpage:"index.html",vat:0,vattype:"none",currency:"â‚¬",currency_id:"EUR",currency_format:"#.###,@@[C]",post_url:"x5cart.php",order_no_format:"[yy][mm][dd]-[A-Z][0-9][A-Z][0-9]",form_autocomplete:!0,form_validation:"tip",showShipmentFields:!1,continue_shopping_page:"index.html",remove_from_cart_icon:"cart/images/cart-remove.png",add_to_cart_icon:"cart/images/cart-add.png",minimumAmount:0,currencies:["USD","EUR"],cartCookie:"x5CartProducts",formCookie:"x5CartForm"},products:{},shippings:{},payments:{},form:{fields:{},agreement:"",acceptAgreement:!1}},d);var e={},f=null,g=null,h={},i=0,j={},k=0,l=null,m=0,n={},o={},p="",q=this,r={"x5cart.priceChanged":a.Callbacks(),"x5cart.quantityChanged":a.Callbacks()};for(var s in d.shippings)d.shippings[s]&&(k++,j[s]=new b.cart.shipping(d.shippings[s]));for(var t in d.payments)d.payments[t]&&(i++,h[t]=new b.cart.payment(d.payments[t]));this.formatCurrency=function(a,c,e){e=e||d.settings.currency,c=c||d.settings.currency_format,c.match(/(\[C\])?[#]+(,|\.)?[#]*(,|\.)?([@]*)(\[C\])?/gi);var f=b.utils,g=RegExp.$2,h=RegExp.$3,i=RegExp.$4,j=RegExp.$1,k=RegExp.$5,l="",m=f.round(a,i.length),n=0|m,o=f.round(m-n,i.length),p=0,q;!!g.length&&!h.length&&!!i.length&&(h=g,g=""),n+="",p=n.length;for(q=p-1;q>=0;q--)(p-q-1)%3===0&&p-q-1>0&&(l=g+l),l=n.charAt(q)+l;if(i.length){o=(o+"").replace(/0\./,"").substring(0,i.length);while(o.length<i.length)o+="0";l+=h+o}return(j?e+" ":"")+l+(k?" "+e:"")},this.settings=function(b){return b&&a.extend(d.settings,b),d.settings},this.form=function(){return d.form},this.add=function(a,c,f,g,h){var i=new b.cart.product(d.products[a],{quantity:c,option:f,suboption:g}),j=i.hash();return j in e&&!h&&i.quantity(e[j].quantity()+c),e[j]=i,this.save(),r["x5cart.priceChanged"].fire(),r["x5cart.quantityChanged"].fire(),j},this.remove=function(a){if(e[a]===null||e[a]===undefined)return!1;var b={};for(var c in e)c!=a&&(b[c]=e[c]);return e=b,this.save(),r["x5cart.priceChanged"].fire(),r["x5cart.quantityChanged"].fire(),!0},this.update=function(a,c,d,f){if(a in e){var g=e[a];if(d&&g.option()!=d||!isNaN(f)&&g.subOption()!=f){var h=this.add(g.id(),c,d?d:g.option(),isNaN(f)?g.subOption():f);this.remove(a),r["x5cart.priceChanged"].fire(),this.save(),a=h}else e[a].quantity()!=c&&(e[a].quantity(c),r["x5cart.priceChanged"].fire(),r["x5cart.quantityChanged"].fire(),this.save());return a}throw{message:b.l10n.get("cart_product_unknown","Unknown product")}},this.cart=function(){return e},this.count=function(a){a=a!==null&&a!==undefined?a:!0;var b=0;for(var c in e)b+=a?e[c].quantity():1;return b},this.category=function(a){var c={},e=null;for(var f in d.products)e=d.products[f],e.category==a&&(c[f]=new b.cart.product(d.products[e.id],{quiet:!0}));return c},this.store=function(a){var c;if(!a){var e={},f;for(c in d.products)f=d.products[c],e[c]=new b.cart.product(f,{quiet:!0});return e}return a in d.products?(c=d.products[a],new b.cart.product(c,{quiet:!0})):null},this.shippings=function(){return j},this.shippingsCount=function(){return k},this.payments=function(){return h},this.paymentsCount=function(){return i},this.payment=function(a,b){return b=b===null||b===undefined?!0:b,a&&h[a]&&(g=a,b&&this.save()),r["x5cart.priceChanged"].fire(),g!==null&&h[g]?h[g]:null},this.shipping=function(a,b){return b=b===null||b===undefined?!0:b,a&&j[a]&&(f=a,b&&this.save()),r["x5cart.priceChanged"].fire(),f!==null&&j[f]?j[f]:null},this.userInvoiceData=function(a,b){return b=b===null||b===undefined?!0:b,a!==null&&a!==undefined&&(n=a,b&&this.save()),n?n:[]},this.userShippingData=function(a,b){return b=b===null||b===undefined?!0:b,a!==null&&a!==undefined&&(o=a,b&&this.save()),o},this.goodsVat=function(){return this.goodsPrice(!0)-this.goodsPrice(!1)},this.vat=function(){return this.goodsVat()+(f&&j[f]&&this.count()?j[f].vat(this.goodsWeight(),this.goodsPrice(!1)):0)+(g&&h[g]&&this.count()?h[g].vat():0)},this.fullPrice=function(a){return this.goodsFullPrice(a)+(f&&j[f]&&this.count()?j[f].price(a,this.goodsWeight(),this.goodsPrice(a)):0)+(g&&h[g]&&this.count()?h[g].price(a):0)},this.price=function(a){var b=this.goodsPrice(a)+(f&&j[f]&&this.count()?j[f].price(a,this.goodsWeight(),this.goodsPrice(a)):0)+(g&&h[g]&&this.count()?h[g].price(a):0);return Math.max(0,b-b*m)},this.goodsFullPrice=function(a){var b=0;for(var c in e)e[c]&&(b+=e[c].fullPrice(a));return b},this.goodsPrice=function(a){var b=0;for(var c in e)e[c]&&(b+=e[c].price(a));return b},this.goodsWeight=function(){var a=0;for(var b in e)e[b]&&(a+=e[b].weight());return a},this.canSetOrder=function(){var a={success:!1,message:""};return this.count()===0?a.message=b.l10n.get("cart_err_emptycart"):k>0&&this.shipping()===null?a.message=b.l10n.get("cart_err_shipping"):i>0&&this.payment()===null?a.message=b.l10n.get("cart_err_payment"):d.settings.minimumAmount>this.goodsPrice(d.settings.vattype=="included")?a.message=b.l10n.get("cart_err_minimum_price").replace(/\[PRICE\]/g,this.formatCurrency(d.settings.minimumAmount)):a.success=!0,a},this.paymentHTML=function(){var a=this.payment()?this.payment().html():"",d=b.utils.htmlspecialchars,e,f,g,h,i=!0,j=this.userInvoiceData(),k=this.userShippingData(),l=["Name","LastName","Address1","Address2","City","StateRegion","Country","ZipPostalCode","Email","Phone","Adverts","Note"];if(a==="")return"";a=a.replace(/\[ORDER_NO\]/g,p).replace(/\[HESCAPE_ORDER_NO\]/g,d(p)).replace(/\[UESCAPE_ORDER_NO\]/g,c.escape(p)),e=this.formatCurrency(this.price(i),"#.@@@"),a=a.replace(/\[PRICE\]/g,e).replace(/\[HESCAPE_PRICE\]/g,d(e)).replace(/\[UESCAPE_PRICE\]/g,c.escape(e));while(h=a.match(/\[PRICE,\s*([0-9]+),\s*([\w#@\.,\[\]]+)\]/))e=this.price(i)*parseInt(h[1],10),e=this.formatCurrency(e.toString(),h[2]),g=h[0].replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\./g,"\\."),a=a.replace(new RegExp(g,"g"),e);while(h=a.match(/\[(H|U)ESCAPE_PRICE,\s*([0-9]+),\s*([\w#@\.,\[\]]+)\]/))e=this.price(i)*parseInt(h[2],10),e=this.formatCurrency(e.toString(),h[3]),g=h[0].replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\./g,"\\."),a=a.replace(new RegExp(g,"g"),RegExp.$1=="U"?c.escape(e):d(e));for(var m=0;m<l.length;m++){var n=l[m],o=n.toUpperCase(),q=j[n]?j[n].value:"",r=k[n]?k[n].value:"";a=a.replace(new RegExp("\\["+o+"\\]","g"),q).replace(new RegExp("\\[HESCAPE_"+o+"\\]","g"),d(q)).replace(new RegExp("\\[UESCAPE_"+o+"\\]","g"),c.escape(q)).replace(new RegExp("\\[SHIPPING_"+o+"\\]","g"),r).replace(new RegExp("\\[HESCAPE_SHIPPING_"+o+"\\]","g"),d(r)).replace(new RegExp("\\[UESCAPE_SHIPPING_"+o+"\\]","g"),c.escape(r))}return a},this.setOrder=function(c){var f=this.canSetOrder(),g={},h={},i,j,k,l;if(f.success!==!0){a.isFunction(c)&&c({success:!1,message:f});return}p=function(){var a=d.settings.order_no_format,b=new Date,c=b.getDate(),e=b.getMonth()+1,f=b.getFullYear().toString().substring(2);parseInt(c,10)<10&&(c="0"+c),parseInt(e,10)<10&&(e="0"+e),a=a.replace(/\[dd\]/g,c).replace(/\[mm\]/g,e).replace(/\[yy\]/g,f).replace(/\[yyyy\]/g,b.getFullYear());while(a.indexOf("[A-Z]")!=-1)a=a.replace("[A-Z]",String.fromCharCode(Math.round(Math.random()*25+65)));while(a.indexOf("[a-z]")!=-1)a=a.replace("[a-z]",String.fromCharCode(Math.round(Math.random()*25+97)));while(a.indexOf("[0-9]")!=-1)a=a.replace("[0-9]",Math.round(Math.random()*9));return a}();var m={success:!0,orderNo:p,shipping:this.shipping(),payment:this.payment(),cart:this.cart(),userInvoiceData:this.userInvoiceData(),userShippingData:this.userShippingData()};this.save();if(!b.utils.isOnline())a.isFunction(c)&&c(m);else{for(k in e)l=e[k],i="options"in l.base()&&l.option()&&l.base().options[l.option()]?l.base().options[l.option()].name:null,j=i&&"suboptions"in l.base().options[l.option()]?l.base().options[l.option()].suboptions[l.subOption()]:null,g[k]={name:l.base().name,description:l.base().description,option:i,suboption:j,rawSinglePrice:l.singlePrice(!1),rawSinglePricePlusVat:l.singlePrice(!0),rawSingleFullPrice:l.singleFullPrice(!1),rawSingleFullPricePlusVat:l.singleFullPrice(!0),rawPrice:l.price(!1),rawPricePlusVat:l.price(!0),rawFullPrice:l.fullPrice(!1),rawFullPricePlusVat:l.fullPrice(!0),rawSingleVat:l.singleVat(),rawVat:l.vat(),singlePrice:this.formatCurrency(l.singlePrice(!1)),singlePricePlusVat:this.formatCurrency(l.singlePrice(!0)),singleFullPrice:this.formatCurrency(l.singleFullPrice(!1)),singleFullPricePlusVat:this.formatCurrency(l.singleFullPrice(!0)),price:this.formatCurrency(l.price(!1)),pricePlusVat:this.formatCurrency(l.price(!0)),fullPrice:this.formatCurrency(l.fullPrice(!1)),fullPricePlusVat:this.formatCurrency(l.fullPrice(!0)),vat:this.formatCurrency(l.vat()),singleVat:this.formatCurrency(l.singleVat()),quantity:l.quantity()};h={orderNo:p,userInvoiceData:this.userInvoiceData(),userShippingData:this.userShippingData(),products:g,rawTotalPrice:this.price(!1),rawTotalPricePlusVat:this.price(!0),rawTotalVat:this.vat(),totalPrice:this.formatCurrency(this.price(!1)),totalPricePlusVat:this.formatCurrency(this.price(!0)),totalVat:this.formatCurrency(this.vat()),currency:d.settings.currency_id},this.shipping()&&(h=a.extend(h,{shipping:{name:this.shipping().name(),description:this.shipping().description(),email_text:this.shipping().email(),price:this.formatCurrency(this.shipping().price(!1,this.goodsWeight(),this.goodsPrice(!1))),pricePlusVat:this.formatCurrency(this.shipping().price(!0,this.goodsWeight(),this.goodsPrice(!0))),rawPrice:this.shipping().price(!1,this.goodsWeight(),this.goodsPrice(!1)),rawPricePlusVat:this.shipping().price(!0,this.goodsWeight(),this.goodsPrice(!0)),vat:this.formatCurrency(this.shipping().vat()),rawVat:this.shipping().vat()}})),this.payment()&&(h=a.extend(h,{payment:{name:this.payment().name(),description:this.payment().description(),price:this.formatCurrency(this.payment().price(!1)),pricePlusVat:this.formatCurrency(this.payment().price(!0)),rawPrice:this.payment().price(!1),rawPricePlusVat:this.payment().price(!0),email_text:this.payment().email(),vat:this.formatCurrency(this.payment().vat()),rawVat:this.payment().vat(),html:this.paymentHTML(),htmlCheck:'<a href="http://google.it">escapecheck</a>'}}));var n=d.settings.post_url;n+=n.indexOf("?")==-1?"?":"&",a.ajax({url:n+"action=sndrdr&"+Math.round(Math.random()*1e4),type:"POST",dataType:"json",data:{orderData:h},success:function(b){b!==null&&b!==undefined&&"orderNo"in b?(p=b.orderNo,m.orderNo=b.orderNo):(m.success=!1,m.message="Unable to set your order"),a.isFunction(c)&&c(m)},error:function(){a.isFunction(c)&&c({success:!1,message:"Error while sending your order"})}})}},this.orderNumber=function(){return p},this.empty=function(a){a=a===null||a===undefined?!0:a,f=g=l=p=null,e={},r["x5cart.priceChanged"].fire(),r["x5cart.quantityChanged"].fire(),a&&this.save()},this.save=function(){var a=[],b={crt:[],shp:null,pay:null,cpn:null,orderNo:null},h=!1;f&&(b.shp=f),g&&(b.pay=g),p&&(b.orderNo=p);for(var i in e){var j=e[i],k={id:j.id(),qnt:j.quantity(),opt:null,sopt:null};j.option()&&(k.opt=j.option(),j.subOption()&&(k.sopt=j.subOption())),b.crt.push(k)}c.localStorage.setItem(d.settings.cartCookie,JSON.stringify(b)),c.localStorage.setItem(d.settings.formCookie,JSON.stringify({ivc:this.userInvoiceData(),shp:this.userShippingData()}))},this.load=function(){try{var a=JSON.parse(c.localStorage.getItem(d.settings.cartCookie,null)),h=JSON.parse(c.localStorage.getItem(d.settings.formCookie,null));if(a){if("crt"in a){e={};for(var i=0;i<a.crt.length;i++){var j=a.crt[i],k,m;d.products[j.id]&&(k=new b.cart.product(d.products[j.id],{quantity:j.qnt*1,option:j.opt,suboption:j.sopt}),e[k.hash()]=k)}}"shp"in a&&d.shippings[a.shp]?f=a.shp:f=null,"pay"in a&&d.payments[a.pay]?g=a.pay:g=null,l=null,"orderNo"in a?p=a.orderNo:p=null,r["x5cart.priceChanged"].fire()}return h&&(n="ivc"in h?h.ivc:{},o="shp"in h?h.shp:{}),!0}catch(q){}return!1},this.bind=function(a,b){return a in r?r[a].has(b)?this:(r[a].add(b),this):this},this.unbind=function(a,b){return a in r?(b?r[a].remove(b):r[a].empty(),this):this},this.load()}})})(_jq,x5engine,window),function(a,b){"use strict",a.extend(!0,b.cart,{product:function(c,d){var e=a.extend(!0,{id:null,id_user:null,category:null,description:"",price:0,images:[],link:null,vat:0,vattype:"none",weight:0,avail:"unknown",precision:5,options:{},discount:{type:"relative",amount:0,coupon:!1},quantityDiscounts:{},minQuantity:0},c),f=a.extend(!0,{quantity:e.minQuantity>0?e.minQuantity:1,quiet:!1,option:null,suboption:null},d),g=!1,h=function(a,b){return b[0]===null||b[0]===undefined?0:b[0]};this.hash=function(){return b.utils.imHash(this.id()+(f.option?f.option:"")+(isNaN(f.suboption)?"":f.suboption))},this.base=function(){return a.extend(!0,e,{optionsLength:function(){var a=0;for(var b in e.options)e.options.hasOwnProperty(b)&&a++;return a}})},this.id=function(){return e.id},this.quantity=function(a){if(a){if(isNaN(a)||!/[0-9]+/.test(a)||parseInt(a,10)<1)throw{name:"Product Quantity",message:b.l10n.get("cart_err_qty")};if(e.minQuantity>a&&!f.quiet)throw{name:"Product Quantity",message:b.l10n.get("cart_err_quantity").replace(/\[QUANTITY\]/g,e.min_quantity)};f.quantity=a}return f.quantity},this.option=function(a){return a&&a in e.options&&(f.option=a,"suboptions"in e.options[a]&&f.suboption===null&&(f.suboption=0)),f.option},this.subOption=function(a){return a&&f.option in e.options&&a in e.options[f.option].suboptions&&(f.suboption=a),f.suboption},this.discount=function(a){var b=0,c=e.discount,d=0,h=0;if(!c.coupon||c.coupon&&g)switch(c.type){case"absolute":b+=c.amount;break;case"relative":b+=this.singleFullPrice(a)*c.amount}for(var i in e.quantityDiscounts)f.quantity>=parseFloat(i,10)&&h<e.quantityDiscounts[i]&&(d=i,h=e.quantityDiscounts[d]);return h&&(b+=(this.singleFullPrice(a)-b)*h),b},this.singleFullPrice=function(a){var b=e.price,c=e.options[this.option()];return c&&"pricevar"in c&&(b+=c.pricevar),(b*(a?1+e.vat:1)).toFixed(e.precision)*1},this.singlePrice=function(a){var b=0;switch(e.vattype){case"excluded":b=(this.singleFullPrice(!1)-this.discount(!1))*(a?1+e.vat:1);break;case"included":b=(this.singleFullPrice(!0)-this.discount(!0))/(a?1:1+e.vat);break;default:b=this.singleFullPrice(!1)-this.discount(!1)}return Math.max(0,b)},this.fullPrice=function(a){return this.singleFullPrice(a)*f.quantity},this.price=function(a){return this.singlePrice(a)*f.quantity},this.singleVat=function(){return this.singlePrice(!1)*e.vat},this.fullVat=function(){return this.fullPrice(!1)*e.vat},this.vat=function(){return this.price(!1)*e.vat},this.weight=function(){var a=e.weight,b=e.options[this.option()];return b&&"weightvar"in b&&(a+=b.weightvar),a*f.quantity};if(e.avail=="notavailable"&&!f.quiet)throw{name:"Product Quantity",message:b.l10n.get("cart_product_notavailable","The product is not available now")};this.quantity(f.quantity);if(f.option===null)for(var i in e.options){this.option(i);break}else this.option(f.option)}})}(_jq,x5engine),function(a,b){"use strict",a.extend(!0,b.cart,{shipping:function(b){b=a.extend(!0,{id:null,name:"",description:"",precision:5,vat:0,type:"FIXED",price:0,email:"",image:""},b);var c=0,d=0;this.base=function(){return b},this.id=function(){return b.id},this.name=function(){return b.name},this.description=function(){return b.description},this.image=function(){return b.image},this.price=function(a,c,d){var e,f=0,g=0,h,i=0;switch(b.type){case"WEIGHT":for(h in b.price)c>=parseFloat(h,10)&&(f=h,g=b.price[f]);i=g*(a?1+b.vat:1);break;case"AMOUNT":for(h in b.price)d>=parseFloat(h,10)&&(f=h,g=b.price[f]);i=g*(a?1+b.vat:1);break;default:i=b.price*(a?1+b.vat:1)}return i.toFixed(b.precision)*1},this.vat=function(a,c,d){return b.vat*this.price(!1,a,c,d)},this.email=function(){var a=b.email;return a===null||a===undefined||a===""?"":a}}})}(_jq,x5engine),function(a,b){"use strict",a.extend(!0,b.cart,{payment:function(b){b=a.extend(!0,{id:null,name:"",description:"",image:"",email:"",precision:5,vat:0,price:0,html:""},b),this.base=function(){return b},this.id=function(){return b.id},this.price=function(a){return(b.price+(a?this.vat():0)).toFixed(b.precision)*1},this.vat=function(){return b.vat*this.price(!1)},this.name=function(){return b.name},this.description=function(){return b.description},this.html=function(){var a=b.html;return a===null||a===undefined||a===""?"":a},this.email=function(){var a=b.email;return a===null||a===undefined||a===""?"":a},this.image=function(){return b.image}}})}(_jq,x5engine),function(a,b,c){"use strict",a.extend(!0,b.cart.ui,{show:function(){var d=a("#cartLoading"),e=a("#imCartContainer"),f=b.cart.manager,g=f.settings(),h=g.vattype,i=h=="included",j=b.cart.ui.iconSize,k=b.cart.ui.showProductIcons,l=b.l10n.get,m=a('<h2 style="text-align: center">'+l("cart_err_emptycart")+"</h2>").after(a("<div />").css({"text-align":"center","margin-top":20}).append(a('<input type="button" value="'+l("cart_continue_shopping")+'" />').click(b.cart.ui.resumeShopping))),n=function(c){var d=b.cart.ui.steps,e=0,f,g,h=a("body"),i=a("<div />");for(f=0;f<c;f++)e-=d.image.steps[f].height;for(f=0;f<d.image.steps.length;f++){var j=a("<span>"+l("cart_step"+(f+1)+"_header","Step description "+(f+1))+"</span>").css(d.font).css({"text-align":"center",position:"absolute",top:-1e3});h.append(j),g=j.outerWidth(!0),j.remove(),i.append(j.css({left:d.image.steps[c].offsetX[f]-g/2,top:d.image.steps[c].offsetY[f]})),f===c&&j.css("color",d.font.activeColor)}return i.width(d.image.width).height(d.image.steps[c].height).css({"background-image":"url('"+b.settings.currentPath+d.image.url+"')","background-position":"0 "+e+"px",margin:"0 auto",position:"relative"})},o=function(a,b,c,d,e){var g="";c=c&&c!==1?' colspan="'+(h!="none"?c:c-2)+'"':"",e=e!==null&&e!==undefined?e:!1;switch(h){case"excluded":return g+'<tr class="vertical-middle">'+"<td"+c+' class="invisible"></td>'+'<td class="head" style="width:15%;">'+l("cart_total")+"</td>"+'<td class="text-right" colspan="2">'+f.formatCurrency(a)+"</td>"+"</tr>"+'<tr class="vertical-middle">'+"<td"+c+' class="invisible"></td>'+'<td class="head">'+l("cart_vat")+"</td>"+'<td class="text-right" colspan="2" style="width:'+d+'%">'+f.formatCurrency(b)+"</td>"+"</tr>"+'<tr class="vertical-middle">'+"<td"+c+' class="invisible"></td>'+'<td class="head" style="border-bottom: none;">'+l("cart_total_vat")+"</td>"+'<td class="text-right" colspan="2">'+f.formatCurrency(a+b)+"</td>"+"</tr>";case"included":return g+'<tr class="vertical-middle">'+"<td"+c+' class="invisible"></td>'+'<td class="head" style="width:15%;">'+l("cart_total_vat")+"</td>"+'<td class="text-right" colspan="2" style="width:'+d+'%">'+f.formatCurrency(a+b)+"</td>"+"</tr>"+'<tr class="vertical-middle">'+"<td"+c+' class="invisible"></td>'+'<td class="head" style="border-bottom: none;"">'+l("cart_vat_included","VAT (Included)")+"</td>"+'<td class="text-right" colspan="2">'+f.formatCurrency(b)+"</td>"+"</tr>";case"none":return g+'<tr class="vertical-middle">'+"<td"+c+' class="invisible"></td>'+'<td class="head" style="width:15%; border-bottom: none;">'+l("cart_total")+"</td>"+'<td class="text-right" colspan="2" style="width:'+d+'%">'+f.formatCurrency(a)+"</td>"+"</tr>"}},p=function(){var b=a("#imContent");a("#imCartContainer img").one("load",function(){b.trigger("change")}),b.trigger("change")},q=function(c){var d="",g=f.category(c),m,n,o,q=!1,r=!1,s=0;a(".imTip").remove(),e.empty();for(o in g)if(g[o].base().optionsLength()>0){q=!0;break}e.append('<h2 id="imPgTitle" class="imTitleMargin">'+l("cart_category")+"</h2>").append("<p>"+l("cart_step1_descr")+"</p>"),d+='<table class="cartTable"><thead><tr><td class="first-x">'+l("cart_descr")+"</td>"+(q?"<td>"+l("cart_opt")+"</td>":"")+"<td>"+l("cart_price")+"</td>"+(h!=="none"?"<td>"+l("cart_vat")+"</td>":"")+"<td>"+l("cart_qty")+"</td>"+'<td class="last-x"></td>'+"</tr>"+"</thead>"+"<tbody>";for(o in g){m=g[o],d+="<tr><td>"+(k&&m.base().images.length?'<img src="../'+m.base().images[0]+'" alt="'+m.base().name+'" style="float: left; margin: 5px 5px 5px 0; width: '+j+'px;" />':"")+"<b>"+m.base().name+"</b><p>"+m.base().description+"</p></td>"+"</td>";if(q){r=null,d+="<td>";if(m.base().optionsLength()>0){d+='<select data-hash="'+o+'" data-type="option" id="opt-'+o+'">';for(var t in m.base().options)r===null&&(r="suboptions"in m.base().options[t]&&m.base().options[t].suboptions.length>0?t:!1),d+='<option value="'+t+'">'+m.base().options[t].name+"</option>";d+="</select>";if(r){var u=m.base().options[r].suboptions;d+='<select data-hash="'+o+'" id="subopt-'+o+'">';for(var v=0;v<u.length;v++)d+='<option value="'+v+'">'+u[v]+"</option>";d+="</select>"}}d+="</td>"}d+='<td id="price-'+o+'">'+f.formatCurrency(m.singlePrice(i))+"</td>"+(h!=="none"?'<td id="vat-'+o+'">'+f.formatCurrency(m.vat())+"</td>":"")+"<td>"+'<input size="2" type="text" value="'+m.quantity()+'" id="qty-'+o+'" class="text-right">'+"</td>"+'<td style="vertical-align: middle; text-align: center;">'+'<img src="../'+f.settings().add_to_cart_icon+'" data-type="add" data-hash="'+o+'" style="cursor: pointer;">'+"</td>"+"</tr>"}d+="</tbody></table>",d=a(d),d.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),d.find("tr").each(function(){var b=a(this).find("td");b.first().addClass("first-x"),b.last().addClass("last-x")}),d.find("tr").last().find("td").addClass("last-y"),d.find("select[data-type=option]").change(function(){var b=a(this),c=b.attr("data-hash"),d=null;if(c&&(d=g[c])){var e,j=b.val();a("#subopt-"+c).remove();if("suboptions"in d.base().options[j]&&d.base().options[j].suboptions.length>0){e='<select id="subopt-'+c+'">';for(var k=0;k<d.base().options[j].suboptions.length;k++)e+='<option value="'+d.base().options[j].suboptions[k]+'">'+d.base().options[j].suboptions[k]+"</option>";e+="</select>",b.after(e)}b.attr("data-type")=="option"?g[c].option(b.val()):b.attr("data-type")=="suboption"&&g[c].subOption(b.val()),a("#price-"+c).html(f.formatCurrency(g[c].singlePrice(i))),h!="none"&&a("#vat-"+c).html(f.formatCurrency(g[c].singleVat()))}return!1}),d.find("img[data-type=add]").click(function(){var c=a(this),d=c.attr("data-hash");b.cart.ui.addToCart(g[d].id(),a("#qty-"+d).val(),a("#opt-"+d).val(),a("#subopt-"+d).val(),!0,"../")}),e.append(d),p()},r=function(){var d=null,q=null,s=null,t=null,u=null,v=null,w=null,x=function(){var b=f.cart(),m,n,p=!1,q=!1,s="",t="";for(s in b)if(b[s].option()!==null){p=!0;break}t='<div><table class="cartTable" cellpadding="0" cellspacing="0" border="0" style="margin-bottom: 0;"><thead><tr><td>'+l("cart_descr")+"</td>"+(p?'<td style="min-width: 80px;">'+l("cart_opt")+"</td>":"")+'<td style="min-width: 100px;">'+l("cart_price")+"</td>"+"<td>"+l("cart_qty")+"</td>"+(h!="none"?'<td style="width: 15%;">'+(i?l("cart_vat_included"):l("cart_vat"))+"</td>":"")+'<td style="width: 15%;">'+l("cart_subtot")+"</td>"+'<td style="width: 6%; text-align: center;"></td>'+"</tr></thead><tbody>";for(s in b){m=b[s];if(m){n=m.base().options,q=!1,t+="<tr><td>"+(k&&m.base().images.length?'<img src="../'+m.base().images[0]+'" alt="'+m.base().name+'" style="float: left; margin: 5px 5px 5px 0; width: '+j+'px;" />':"")+"<b>"+m.base().name+"</b><p>"+m.base().description+"</p></td>";if(p){t+="<td>";if(m.base().optionsLength()>0){t+='<select data-type="option" data-hash="'+s+'" >';for(var u in n)t+='<option value="'+u+'"'+(m.option()==u?" selected":"")+">"+n[u].name+"</option>",m.option()==u&&(q=typeof m.base().options[u].suboptions=="object");t+="</select>";if(q){var v=m.base().options[m.option()].suboptions;t+='<select data-type="suboption" data-hash="'+s+'">';for(var w=0;w<v.length;w++)t+='<option value="'+w+'"'+(w==m.subOption()?" selected":"")+">"+v[w]+"</option>";t+="</select>"}}t+="</td>"}t+='<td class="text-right">'+f.formatCurrency(m.singlePrice(i))+(m.discount()>0?'<span style="text-decoration: line-through; margin-left: 5px;">'+f.formatCurrency(m.singleFullPrice(i))+"</span>":"")+"</td>"+'<td class="text-right"><input data-hash="'+s+'" type="text" size="2" value="'+m.quantity()+'" class="text-right"></td>'+(h!="none"?'<td class="text-right">'+f.formatCurrency(m.vat())+" ("+Number(m.base().vat*100).toFixed(2)+"%)"+"</td>":"")+'<td class="text-right">'+f.formatCurrency(m.price(i))+"</td>"+'<td><img data-hash="'+s+'" data-action="delete" style="vertical-align: middle; cursor: pointer;" src="../'+g.remove_from_cart_icon+'" alt="'+l("cart_remove")+'" title="'+l("cart_remove")+'" /></td>'+"</tr>"}}t+="</tbody></table>",t+='<table class="cartTable" cellpadding="0" cellspacing="0" border="0" style="margin-top: 0;"><tbody>'+o(f.goodsPrice(!1),f.goodsVat(),p?4:3,21)+"</tbody>"+"</table></div>",t=a(t),t.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),t.find("table").each(function(b){var c=a(this).find("tr");c.each(function(d){var e=a(this).find("td").not(".invisible");e.first().addClass("first-x"),e.last().addClass("last-x"),b===0&&d==c.length-1&&e.last().css("border-radius",0),b==1&&d===0&&e.css({"border-top-left-radius":0,"border-top-right-radius":0,"border-top-color":"transparent"})}),c.last().find("td").not(".invisible").addClass("last-y")}),t.find("select").change(function(){var b=a(this),d=b.attr("data-hash"),e=null;if(d&&(e=f.cart()[d])){var g,h;b.attr("data-type")=="option"?(g=b.val(),h=e.base().options[g].suboptions?0:null):(g=e.option(),h=b.val());try{f.update(d,e.quantity()*1,g,h)}catch(i){c.alert(i.message)}x(),z(),y(),A()}return!1}),t.find("img[data-action=delete]").click(function(){var b=a(this).attr("data-hash");if(c.confirm(l("cart_remove_q"))&&b&&f.remove(b)){if(f.count()===0){r();return}x(),z(),y(),A()}return!1}),t.find("input").change(function(){var d=a(this),e=a(this).attr("data-hash"),g=d.val();if(b[e]){try{f.update(e,g,b[e].option(),b[e].subOption())}catch(h){c.alert(h.message)}x(),z(),y(),A()}return!1}),d===null?e.append(t):d.replaceWith(t),d=t},y=function(){var b=f.shippings(),c=f.shipping(),d="";if(f.shippingsCount()===0)return;d='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td style="width: 20px"></td><td>'+l("cart_shipping")+"</td>"+(h!="none"?'<td style="width: 21%;">'+(i?l("cart_vat_included"):l("cart_vat"))+"</td>":"")+'<td style="width: '+(h!="none"?15:21)+'%;">'+l("cart_price")+"</td>"+"</tr></thead><tbody>";for(var g in b)d+='<tr><td><input type="radio" id="chk-shipping-'+g+'" name="shipping-method" data-id="'+g+'"'+(c&&c.id()==g?" checked":"")+"></td>"+"<td>"+(b[g].image()?'<img src="../'+b[g].image()+'" alt="'+b[g].name()+'" style="float: left; margin: 5px 5px 5px 0;"/>':"")+'<label for="chk-shipping-'+g+'"><b>'+b[g].name()+"</b><p>"+b[g].description()+"</p></label></td>"+(h!="none"?'<td class="text-right">'+f.formatCurrency(b[g].vat(f.goodsWeight(),f.goodsPrice(i)))+" ("+Number(b[g].base().vat*100).toFixed(2)+"%)"+"</td>":"")+'<td class="text-right">'+f.formatCurrency(b[g].price(i,f.goodsWeight(),f.goodsPrice(i)))+"</td>"+"</tr>";d+="</tbody></table>",d=a(d),d.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),d.find("tr").each(function(){var b=a(this).find("td").not(".invisible");b.first().addClass("first-x"),b.last().addClass("last-x")}),d.find("tr").last().find("td").not(".invisible").addClass("last-y"),d.find("input[type=radio]").click(function(){var b=a(this).attr("data-id");b&&(f.shipping(b),A())}),q===null?e.append(d):q.replaceWith(d),q=d},z=function(){var b=f.payments(),c=f.payment(),d="";if(f.paymentsCount()===0)return;d='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td style="width: 20px"></td><td>'+l("cart_payment")+"</td>"+(h!="none"?'<td style="width: 21%;">'+(i?l("cart_vat_included"):l("cart_vat"))+"</td>":"")+'<td style="width: '+(h!="none"?15:21)+'%;">'+l("cart_price")+"</td>"+"</tr></thead><tbody>";for(var g in b)d+='<tr><td><input type="radio" id="chk-payment-'+g+'" name="payment-method" data-id="'+g+'"'+(c&&c.id()==g?" checked":"")+"></td>"+"<td>"+(b[g].image()?'<img src="../'+b[g].image()+'" alt="'+b[g].name()+'" style="float: left; margin: 5px 5px 5px 0;"/>':"")+'<label for="chk-payment-'+g+'"><b>'+b[g].name()+"</b><p>"+b[g].description()+"</p></label></td>"+(h!="none"?'<td class="text-right">'+f.formatCurrency(b[g].vat())+" ("+Number(b[g].base().vat*100).toFixed(2)+"%)"+"</td>":"")+'<td class="text-right">'+f.formatCurrency(b[g].price(i))+"</td>"+"</tr>";d+="</tbody></table>",d=a(d),d.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),d.find("tr").each(function(){var b=a(this).find("td").not(".invisible");b.first().addClass("first-x"),b.last().addClass("last-x")}),d.find("tr").last().find("td").not(".invisible").addClass("last-y"),d.find("input").click(function(){var b=a(this).attr("data-id");b&&(f.payment(b),A())}),s===null?e.append(d):s.replaceWith(d),s=d},A=function(){if(f.paymentsCount()===0&&f.shippingsCount()===0)return;var b,c='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><tbody>'+o(f.price(!1),f.vat(),null,21,!0)+"</tbody>"+"</table>";c=a(c),c.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),b=c.find("tr"),b.each(function(){var b=a(this).find("td").not(".invisible");b.first().addClass("first-x"),b.last().addClass("last-x")}),b.first().find("td").not(".invisible").addClass("first-y"),b.last().find("td").not(".invisible").addClass("last-y"),t===null?e.append(c):t.replaceWith(c),t=c};a(".imTip").remove(),b.utils.scrollTo(0),e.empty();if(f.count()===0){e.append(m);return}b.cart.ui.steps.active&&e.append(n(0)),e.append('<h2 id="imPgTitle" class="imTitleMargin">'+l("cart_step1")+"</h2>"),e.append("<p>"+l("cart_step1_cartlist").replace("[FIELD]",l("cart_step1_gonext"))+"</p>"),x(),e.append("<p>"+l("cart_step1_shiplist").replace("[FIELD]",l("cart_step1_gonext"))+"</p>"),y(),z(),A(),v=a('<input type="button" value="'+l("cart_continue_shopping")+'" />').click(b.cart.ui.resumeShopping),w=a('<input type="button" id="btnempty" value="'+l("cart_empty_button")+'" />').click(function(){c.confirm(l("cart_empty"))&&(b.utils.scrollTo(0),f.empty(),b.cart.ui.show("step1"))}),u=a('<input type="button" id="btngonext" value="'+l("cart_step1_gonext",l("cart_gonext"))+'" />').click(function(){var a=f.canSetOrder();a.success!==!0?c.alert(a.message):c.top.location.hash="#step2"}),e.append(a("<div />").addClass("buttons-container").append(v).append(w).append(u)),p(),!!s&&s.find("input[type=radio]").length==1&&s.find("input[type=radio]").click(),!!q&&q.find("input[type=radio]").length==1&&q.find("input[type=radio]").click()},s=function(d){var h=null,i=null,j=f.userInvoiceData(),k=f.userShippingData(),m=a('<table class="userForm"/>'),o=a('<table class="userForm"/>'),q=f.form().fields,r,s,t;if(f.count()===0){c.top.location.href=g.indexpage+"#step1";return}a(".imTip").remove(),b.utils.scrollTo(0),e.empty(),b.cart.ui.steps.active&&e.append(n(1)),e.append('<h2 id="imPgTitle" class="imTitleMargin">'+l("cart_step2")+"</h2>").append("<p>"+l("cart_step2_descr").replace("[FIELD]",l("cart_step2_gonext"))+"</p>"),m.append("<caption>"+l("cart_vat_address")+"</caption>");for(s=0;s<q.length;s++)t=q[s],r=g.formAutocomplete&&j[t.id]?j[t.id].value:t.value?t.value:"",m.append('<tr style="vertical-align: middle;"><td style="width: 35%"><label for="'+t.id+'">'+t.name+(t.mandatory?"*":"")+" </label></td>"+(t.type!="TextArea"?'<td><input type="'+t.type+'" id="'+t.id+'" value="'+r+'" class="'+(t.mandatory?"mandatory ":"")+(t.filter?t.filter:"")+'"></td>':'<td><textarea id="'+t.id+'" class="'+(t.mandatory?"mandatory ":"")+(t.filter?t.filter:"")+'">'+r+"</textarea></td>")+"</td>");e.append(m.css("margin","0 auto"));var u=m.find("input").first();u.length&&u.val().length===0&&u.focus();if(g.showShipmentFields){var v=!1;o.append("<caption>"+l("cart_shipping_address")+"</caption>");for(s=0;s<q.length;s++)t=q[s],t.shipping&&(r=g.formAutocomplete&&k[t.id]?k[t.id].value:t.value?t.value:"",v=v||k[t.id]!==null&&k[t.id]!==undefined,o.append('<tr><td style="width: 35%"><label for="shipping-'+t.id+'">'+t.name+(t.mandatory?"*":"")+" </label></td>"+'<td><input id="shipping-'+t.id+'" type="'+t.type+'" value="'+r+'" class="'+(t.mandatory?"mandatory ":"")+(t.filter?t.filter:"")+'"></td>'+"</td>"));e.append(a('<div id="shippingForm" />').css({"text-align":"center",margin:"5px 0"}).append(a('<input type="checkbox" id="chk-shipping"'+(v?" checked":"")+" />").change(function(){a(this).prop("checked")?a("#shippingFormWrapper").slideDown(250,function(){a("#imContent").triggerHandler("change")}):a("#shippingFormWrapper").slideUp(250,function(){a("#imContent").triggerHandler("change")})})).append(a('<label for="chk-shipping">'+l("cart_shipping_option")+"</label>"))).append(o),o.css("margin","20px auto").wrap('<div id="shippingFormWrapper">'),v||a("#shippingFormWrapper").slideUp(0)}h=a('<input type="button" value="'+l("cart_step2_gonext",l("cart_gonext"
))+'" />').click(function(){var d=b.imForm.validate,e={type:g.formValidation,showAll:!0,position:"right"};j={};for(s=0;s<q.length;s++)j[q[s].id]={label:q[s].name,value:a("#"+q[s].id).val()};f.userInvoiceData(j),k={};if(g.showShipmentFields&&a("#chk-shipping").prop("checked"))for(s=0;s<q.length;s++)q[s].shipping&&(k[q[s].id]={label:q[s].name,value:a("#shipping-"+q[s].id).val()});f.userShippingData(k),d(m,e)&&(!g.showShipmentFields||!a("#chk-shipping").prop("checked")||a("#chk-shipping").prop("checked")&&d(o,e))&&(c.top.location.hash="#step3")}),i=a('<input type="button" value="'+l("cart_step2_goback",l("cart_goback"))+'" />').click(function(){c.top.location.hash="#step1"}),e.append(a("<div />").addClass("buttons-container").append(i).append(h)),p(),d&&b.utils.scrollTo("#"+d)},t=function(){var d=null,j=null,k=f.cart(),m=f.shipping(),q=f.payment(),r=f.userInvoiceData(),s=f.userShippingData(),t=f.form().agreement,u=null,v=null,w=null,x=null,y,z=!1,A="";if(f.count()===0){c.top.location.href=g.indexpage+"#step1";return}a(".imTip").remove(),b.utils.scrollTo(0);for(y in k)if(k[y].option()!==null){z=!0;break}e.empty(),b.cart.ui.steps.active&&e.append(n(2)),e.append('<h2 id="imPgTitle" class="imTitleMargin">'+l("cart_step3")+"</h2>").append("<p>"+l("cart_step3_descr").replace("[FIELD]",l("cart_step3_gonext"))+"</p>"),A+='<div><table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td>'+(!g.showShipmentFields||g.showShipmentFields&&JSON.stringify(s)!="{}"?l("cart_vat_address"):l("cart_vat_address")+" / "+l("cart_shipping_address"))+"</td>"+(g.showShipmentFields&&JSON.stringify(s)!="{}"?'<td style="width: 4%;" class="invisible"></td><td style="width: 48%;">'+l("cart_shipping_address")+"</td>":"")+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<td>"+"<p>"+("Company"in r?r.Company.value+" - ":"")+("Name"in r?r.Name.value+" ":"")+("LastName"in r?r.LastName.value:"")+" "+("Email"in r?"("+r.Email.value+")":"")+"<br />"+("Address1"in r?r.Address1.value+"<br />":"")+("Address2"in r?r.Address2.value+"<br />":"")+("ZipPostalCode"in r?r.ZipPostalCode.value+", ":"")+("City"in r?r.City.value:"")+("StateRegion"in r?" ("+r.StateRegion.value+")":"")+("Country"in r&&r.Country.value?"<br />"+r.Country.value:"")+("Phone"in r&&r.Phone.value?"<br />"+r.Phone.value:"")+("Note"in r&&r.Note.value!==""?"<br /><u>"+r.Note.label+":</u> "+r.Note.value:"")+"</p>"+'<p style="text-align: right;"><a href="#step2" class="button">'+l("cart_edit","Edit")+"</a></p>"+"</td>"+(g.showShipmentFields&&JSON.stringify(s)!="{}"?'<td class="invisible"></td><td><p>'+("Company"in s?s.Company.value+" - ":"")+("Name"in s?s.Name.value+" ":"")+("LastName"in s?s.LastName.value:"")+" "+("Email"in s?"("+s.Email.value+")":"")+"<br />"+("Address1"in s?s.Address1.value+"<br />":"")+("Address2"in s?s.Address2.value+"<br />":"")+("ZipPostalCode"in s?s.ZipPostalCode.value+", ":"")+("City"in s?s.City.value:"")+("StateRegion"in s?" ("+s.StateRegion.value+")":"")+("Country"in s&&s.Country.value?"<br />"+s.Country.value:"")+("Phone"in s&&s.Phone.value?"<br />"+s.Phone.value:"")+("Note"in s&&s.Note.value!==""?"<br /><u>"+s.Note.label+":</u> "+s.Note.value:"")+"</p>"+'<p style="text-align: right;"><a href="#step2/shippingForm" class="button">'+l("cart_edit","Edit")+"</a></p>"+"</td>":"")+"</tr>"+"</tbody>"+"</table>",A+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable" style="margin-bottom: 0"><thead><tr><td>'+l("cart_descr")+"</td>"+(z?'<td style="min-width: 80px;">'+l("cart_opt")+"</td>":"")+'<td style="min-width: 100px;">'+l("cart_price")+"</td>"+"<td>"+l("cart_qty")+"</td>"+(h!="none"?'<td style="width: 15%;">'+(i?l("cart_vat_included"):l("cart_vat"))+"</td>":"")+'<td style="width: 15%;">'+l("cart_subtot")+"</td>"+"</tr></thead><tbody>";for(y in k)v=k[y],v&&(w=v.base().options,x=v.option(),A+="<tr><td><b>"+v.base().name+"</b><p>"+v.base().description+"</p></td>"+(z?"<td>"+(x&&w[x]?w[x].name:"")+(x&&w[x]&&v.subOption()?" "+w[x].suboptions[v.subOption()]:"")+"</td>":"")+'<td class="text-right">'+f.formatCurrency(v.singlePrice(i))+(v.discount()>0?'<span style="text-decoration: line-through; margin-left: 5px;">'+f.formatCurrency(v.singleFullPrice(i))+"</span>":"")+"</td>"+'<td class="text-right">'+v.quantity()+"</td>"+(h!="none"?'<td class="text-right">'+f.formatCurrency(v.vat())+" ("+Number(v.base().vat*100).toFixed(2)+"%)"+"</td>":"")+'<td class="text-right">'+f.formatCurrency(v.price(i))+"</td>"+"</tr>");A+="</tbody></table>",A+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable" style="margin-top: 0;"><tbody>'+o(f.goodsPrice(!1),f.goodsVat(),z?4:3,15)+"</tbody>"+"</table>",m&&(A+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td>'+l("cart_shipping")+"</td>"+(h!="none"?'<td style="width: 15%;">'+(i?l("cart_vat_included"):l("cart_vat"))+"</td>":"")+'<td style="width: 15%;" class="text-right">'+l("cart_price")+"</td>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<td>"+"<b>"+m.name()+"</b>"+"<p>"+m.description()+"</p>"+"</td>"+(h!="none"?'<td class="text-right">'+f.formatCurrency(m.vat(f.goodsWeight(),f.goodsPrice(i)))+"</td>":"")+'<td class="text-right">'+f.formatCurrency(m.price(i,f.goodsWeight(),f.goodsPrice(i)))+"</td>"+"</tr>"+"</tbody>"+"</table>"),q&&(A+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td>'+l("cart_payment")+"</td>"+(h!="none"?'<td style="width: 15%;">'+(i?l("cart_vat_included"):l("cart_vat"))+"</td>":"")+'<td style="width: 15%;" class="text-right">'+l("cart_price")+"</td>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<td><b>"+q.name()+"</b><p>"+q.description()+"</p></td>"+(h!="none"?'<td style="width: 15%;" class="text-right">'+f.formatCurrency(q.vat())+"</td>":"")+'<td style="width: 15%;" class="text-right">'+f.formatCurrency(q.price(i))+"</td>"+"</tr>"+"</tbody>"+"</table>"),m!==null&&q!==null&&(A+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><tbody>'+o(f.price(!1),f.vat(),null,15,!0)+"</tbody>"+"</table>"),A+="</div>",A=a(A),e.append(A),A.find("table").each(function(b){var c=a(this).find("tr");a(this).find("tbody > tr:odd > td").not(".invisible").addClass("odd"),c.each(function(d){var e=a(this).find("td").not(".invisible");e.first().addClass("first-x"),e.last().addClass("last-x"),b===0&&e.addClass("first-x").addClass("last-x"),b==1&&d==c.length-1&&e.last().css("border-radius",0),b==2&&d===0&&e.css({"border-top-right-radius":0,"border-top-left-radius":0,"border-top-color":"transparent"})}),c.first().find("td").not(".invisible").addClass("first-y"),c.last().find("td").not(".invisible").addClass("last-y")}),t!==undefined&&t!==null&&t!==""&&(t=a(t),e.append(t),f.form().acceptAgreement&&(u=a("<div>").append('<input id="chk-agreement" type="checkbox" class="mandatory"><label for="chk-agreement">'+l("cart_agree","I Agree")+"</label>"),t.prepend(u))),d=a('<input type="button" value="'+l("cart_step3_gonext",l("cart_gonext"))+'" />').click(function(){var d=f.canSetOrder(),e=a(this),g=e.attr("value");if(f.form().acceptAgreement&&!b.imForm.validate(t))return!1;d.success!==!0?c.alert(d.message):(e.attr("value",l("cart_order_process")),f.setOrder(function(a){a.success?c.top.location.hash="#step4":(e.attr("value",g),c.alert(a.message))}))}),j=a('<input type="button" value="'+l("cart_step3_goback",l("cart_goback"))+'" />').click(function(){c.top.location.hash="#step2"}),e.append(a("<div />").addClass("buttons-container").append(j).append(d)),p()},u=function(){var d=f.payment(),g=f.paymentHTML();if(!f.canSetOrder().success){c.top.location.hash="#step1";return}a(".imTip").remove(),b.utils.scrollTo(0),e.empty(),b.cart.ui.steps.active&&e.append(n(3)),e.append('<h2 id="imPgTitle" class="imTitleMargin">'+l("cart_step4")+"</h2>").append("<p>"+l("cart_step4_descr")+"</p>").append('<div class="order-number">'+f.orderNumber()+"</div>"),d&&e.append("<p><b>"+d.name()+"</b><br />"+d.email()+"</p>"+(g!==""?'<div id="payment-html">'+g+"</div>":"")),b.utils.isOnline()||b.utils.showOfflineMessage(l("cart_err_offline_email").replace(/\[MAIL\]/g,f.userInvoiceData().Email.value)),a(c).one("hashchange beforeunload",function(){f.empty(!0)}),p()};(function v(b){b||(b=!1);if(b){d.fadeOut(250,v);return}var e=c.top.location.hash.replace("#","").split("/");switch(e[0]){case"category":q(e.length>1?e[1]:null);break;case"step2":s(e.length>1?e[1]:null);break;case"step3":t();break;case"step4":u();break;default:r()}a(c).one("hashchange",v)})(d.is(":visible"))},addToCart:function(d,e,f,g,h,i){var j=b.cart.manager;if(j===null)return;e=e||1,i=i?i:"",h=typeof h=="undefined"?!0:h;try{j.add(d,parseInt(e,10),f,g)&&(h?(a.imCookie("x5CartContinue",c.top.location.href,{path:"/"}),b.utils.location(i+"cart/"+j.settings().indexpage+"#step1")):c.alert(b.l10n.get("cart_product_added")))}catch(k){c.alert(k.message)}return!1},resumeShopping:function(){var d=a.imCookie("x5CartContinue",null,{path:"/"});d?c.top.location.href=d:c.top.location.href="/"+b.cart.manager.settings().continue_shopping_page},updateProductListOptions:function(c,d,e){var f=b.cart.manager,g=f.store(c),h,i,j=a(d),k=a("#"+e+"_fullprice"),l;g.option(j.val()),k.length&&(l=k.parent().attr("data-includevat")=="true",k.html(f.formatCurrency(g.fullPrice(l))),a("#"+e+"_price").html(f.formatCurrency(g.price(l))));if(g){a("#"+e+"_subopt").remove(),h=g.base().options[g.option()];if("suboptions"in h){var m=a('<select id="'+e+'_subopt" style="float: right; width: 47%;"/>');for(i=0;i<h.suboptions.length;i++)m.append('<option value="'+i+'">'+h.suboptions[i]+"</option>");m.val(0),j.width("47%").after(m)}else j.width("99%").css("float","none")}},updateWidget:function(){var c=b.cart.manager,d=b.cart.ui.updateWidget;if(c===null)return setTimeout(d,500);a(".widget_weight_total").text(c.goodsWeight()),a(".widget_quantity_total").text(c.count()),a(".widget_amount_total").text(c.formatCurrency(c.price(c.settings().vattype=="included"))),c.bind("x5cart.priceChanged",d).bind("x5cart.quantityChanged",d)}}),b.cart.loaded=!0}(_jq,x5engine,window);